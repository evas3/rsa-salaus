import unittest
from encryptionkeys import EncryptionKeys

class TestEncryptionKeys(unittest.TestCase):
    def setUp(self):
        pass

    def test_private_key_d_int(self):
        primes = [3130000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001183811000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000313, 3136666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666313, 11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111, 1357911131517193133353739515355575971737577799193959799111113115117119131133135137139151153155157159171173175177179191193195197199311313315317319331333335337339351353355357359371373375377379391393395397399511513515517519531533535537539551553555557559571573575577579591593595597599711713715717719731733735737739751753755757759771, 115922179551495973383410176342643722334557255682879605864838806293659619625004303206250384392546855063844106965156287951749387634112551089284595541103692716528774876311641700929986988023197242224581099872580798960693521778607396791006450968430359009613295725905514216842343121690916290236558767890728449777, 1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000237, 100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000118000000080101811009000118101080000000811000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001, 2357111317192329313741434753596167717379838997101103107109113127131137139149151157163167173179181191193197199211223227229233239241251257263269271277281283293307311313317331337347349353359367373379383389397401409419421431433439443449457461463467479487491499503509521523541547557563569571577587593599601607613617619631641643647653659661673677683691701709719, 23232323232323232323232323232323232323232323231919191919191919191919191919191919191917171717171717171717171717171717171313131313131313131313131311111111111111111111117777777555553335555577777771111111111111111111111131313131313131313131313131717171717171717171717171717171717191919191919191919191919191919191919192323232323232323232323232323232323232323232323, 1294063654237511187554750201560780429214510015005200300103459729051895935678639157755876077558760678639155189593534597290200300101001500542921451560780475020118755237513654406291]
        for i in range(0, 4):
            d = EncryptionKeys().private_key_d(primes[i], primes[-1-i], 65537)
            self.assertEqual(d.is_integer(), True)
            self.assertGreater(d, 0)

    def test_private_key_d_big(self):
        primes = [3136666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666313, 11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111, 1357911131517193133353739515355575971737577799193959799111113115117119131133135137139151153155157159171173175177179191193195197199311313315317319331333335337339351353355357359371373375377379391393395397399511513515517519531533535537539551553555557559571573575577579591593595597599711713715717719731733735737739751753755757759771, 115922179551495973383410176342643722334557255682879605864838806293659619625004303206250384392546855063844106965156287951749387634112551089284595541103692716528774876311641700929986988023197242224581099872580798960693521778607396791006450968430359009613295725905514216842343121690916290236558767890728449777, 1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000237, 100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000118000000080101811009000118101080000000811000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001, 2357111317192329313741434753596167717379838997101103107109113127131137139149151157163167173179181191193197199211223227229233239241251257263269271277281283293307311313317331337347349353359367373379383389397401409419421431433439443449457461463467479487491499503509521523541547557563569571577587593599601607613617619631641643647653659661673677683691701709719, 23232323232323232323232323232323232323232323231919191919191919191919191919191919191917171717171717171717171717171717171313131313131313131313131311111111111111111111117777777555553335555577777771111111111111111111111131313131313131313131313131717171717171717171717171717171717191919191919191919191919191919191919192323232323232323232323232323232323232323232323]
        for i in range(0, 3):
            d = EncryptionKeys().private_key_d(primes[i], primes[-1-i], 65537)
            self.assertGreater(d.bit_length(), 2047)

    def test_public_key_e_range(self):
        for i in range(6*10**30, (6*10**30)+10):
            e = EncryptionKeys().public_key_e(i)
            self.assertGreater(e, 2)
            self.assertLess(e, i)

    def test_public_key_e_integer(self):
        for i in range(6*10**30, (6*10**30)+10):
            e = EncryptionKeys().public_key_e(i)
            self.assertEqual(e.is_integer(), True)

    def test_public_key_e_vs_lam(self):
        for i in range(6*10**30, (6*10**30)+10):
            e = EncryptionKeys().public_key_e(i)
            gcd = EncryptionKeys().gcd(i, e)
            self.assertEqual(gcd, 1)

    def test_gcd_integer(self):
        for i in range(6*10**300, (6*10**300)+10):
            gcd = EncryptionKeys().gcd(i, i*2-3)
            self.assertEqual(gcd.is_integer(), True)
            self.assertGreater(gcd, 0)
    
    def test_gcd_1(self):
        for i in range(6*10**300, (6*10**300)+10):
            gcd = EncryptionKeys().gcd(i, i+1)
            self.assertEqual(gcd, 1)

    def test_gcd_self(self):
        for i in range(6*10**300, (6*10**300)+10):
            gcd = EncryptionKeys().gcd(i, i)
            self.assertEqual(gcd, i)
    
    def test_gcd_non1(self):
        true_gcd = [338, 3, 2, 13, 10, 3, 2, 5, 31, 3]
        lista = [(3268610410, 5424291262), (6039329694, 2734897803), (6324357942, 5660672372), (2206847695, 5536483953), (9306189450, 7599151930), (4961629152, 7773629163), (1715727246, 4609328518), (6961537720, 1264943635), (8578918951, 7570936157), (7196780457, 6306919158)]
        for i in range(0, 10):
            gcd = EncryptionKeys().gcd(lista[i][0], lista[i][1])
            self.assertEqual(gcd, true_gcd[i])
